import"../../assets/modulepreload-polyfill.js";document.addEventListener("DOMContentLoaded",async()=>{const n=document.getElementById("job-preview"),e=document.getElementById("tailor-btn"),o=document.getElementById("status"),r=document.getElementById("progress"),[s]=await chrome.tabs.query({active:!0,currentWindow:!0});try{const t=await chrome.tabs.sendMessage(s.id,{action:"extract_text"});t&&t.text?n.textContent=t.text.substring(0,300)+"...":(n.textContent="Could not extract text. Please ensure you are on a job page.",e.disabled=!0)}catch(t){console.error(t),n.textContent="Error connecting to page. Refresh and try again.",e.disabled=!0}e.addEventListener("click",async()=>{o.classList.remove("hidden"),e.disabled=!0,chrome.runtime.sendMessage({action:"start_tailoring",jobText:n.textContent})}),chrome.runtime.onMessage.addListener(t=>{t.action==="ai_progress"?(r.textContent=`${Math.round(t.progress*100)}%`,t.text&&(o.innerHTML=`${t.text} <span id="progress">${Math.round(t.progress*100)}%</span>`)):t.action==="ai_complete"&&(o.textContent="Done! (Placeholder)",e.disabled=!1)})});
