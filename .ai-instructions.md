# AI Agent Code Formatting & Project Guidelines

**Project:** CVStomize  
**Last Updated:** November 16, 2025

## üéØ Purpose
This document provides standardized formatting rules and project conventions for AI agents working on this codebase. All contributors (human and AI) should follow these guidelines to maintain consistency.

---

## üìÅ Project Structure

### Architecture Overview
```
cvstomize/
‚îú‚îÄ‚îÄ api/              # Backend API (Node.js/Express)
‚îú‚îÄ‚îÄ src/              # Frontend React application
‚îú‚îÄ‚îÄ tests/            # E2E tests (Playwright)
‚îú‚îÄ‚îÄ docs/             # Project documentation
‚îú‚îÄ‚îÄ scripts/          # Utility scripts
‚îú‚îÄ‚îÄ public/           # Static assets
‚îî‚îÄ‚îÄ database/         # Database schemas and migrations
```

### Key Technologies
- **Frontend:** React 18, Material-UI (MUI), Firebase Auth
- **Backend:** Node.js, Express, PostgreSQL
- **Testing:** Playwright, Jest
- **Deployment:** Google Cloud Run, Vercel
- **Version Control:** Git/GitHub

---

## üé® Code Formatting Standards

### JavaScript/React

#### File Structure
```javascript
// 1. Imports - grouped and ordered
import React, { useState, useEffect } from 'react';
import { Box, Button, Typography } from '@mui/material';
import PropTypes from 'prop-types';

// 2. Component definition
const ComponentName = ({ prop1, prop2 }) => {
  // 3. State declarations
  const [state, setState] = useState(initialValue);
  
  // 4. Effects
  useEffect(() => {
    // effect logic
  }, [dependencies]);
  
  // 5. Event handlers
  const handleAction = () => {
    // handler logic
  };
  
  // 6. Helper functions
  const helperFunction = () => {
    // helper logic
  };
  
  // 7. Render
  return (
    <Box>
      {/* JSX content */}
    </Box>
  );
};

// 8. PropTypes
ComponentName.propTypes = {
  prop1: PropTypes.string.isRequired,
  prop2: PropTypes.number,
};

// 9. Default props
ComponentName.defaultProps = {
  prop2: 0,
};

// 10. Export
export default ComponentName;
```

#### Naming Conventions
- **Components:** PascalCase (`UserProfile`, `ResumeEditor`)
- **Files:** Match component name (`UserProfile.js`, `ResumeEditor.js`)
- **Hooks:** camelCase with 'use' prefix (`useAuth`, `useResume`)
- **Utility functions:** camelCase (`formatDate`, `validateEmail`)
- **Constants:** SCREAMING_SNAKE_CASE (`API_BASE_URL`, `MAX_FILE_SIZE`)
- **Private functions:** Prefix with underscore (`_handleInternalLogic`)

#### Code Style Rules
```javascript
// ‚úÖ DO: Use const/let, never var
const userName = 'John';
let counter = 0;

// ‚úÖ DO: Use template literals
const greeting = `Hello, ${userName}!`;

// ‚úÖ DO: Use arrow functions for callbacks
items.map(item => item.id);

// ‚úÖ DO: Destructure props and state
const { name, email } = user;

// ‚úÖ DO: Use optional chaining
const street = user?.address?.street;

// ‚úÖ DO: Use async/await over .then()
const fetchData = async () => {
  try {
    const data = await apiCall();
    return data;
  } catch (error) {
    console.error('Error:', error);
  }
};

// ‚ùå DON'T: Use inline styles (use MUI sx prop or CSS)
// Bad: <div style={{ color: 'red' }}>
// Good: <Box sx={{ color: 'error.main' }}>

// ‚úÖ DO: Use meaningful variable names
const activeUsers = users.filter(u => u.isActive);

// ‚ùå DON'T: Use single letters except in loops/callbacks
// Bad: const d = new Date();
// Good: const currentDate = new Date();
```

### React Component Patterns

#### Functional Components (Preferred)
```javascript
// ‚úÖ DO: Use functional components with hooks
const UserDashboard = ({ userId }) => {
  const [userData, setUserData] = useState(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    const loadUser = async () => {
      try {
        const data = await fetchUser(userId);
        setUserData(data);
      } catch (error) {
        console.error('Failed to load user:', error);
      } finally {
        setLoading(false);
      }
    };
    
    loadUser();
  }, [userId]);

  if (loading) return <LoadingSpinner />;
  if (!userData) return <ErrorMessage />;

  return <UserProfile data={userData} />;
};
```

#### Component Organization
```javascript
// Small components: Single file
// Large components: Directory structure
src/components/
‚îú‚îÄ‚îÄ UserProfile/
‚îÇ   ‚îú‚îÄ‚îÄ index.js              # Main component
‚îÇ   ‚îú‚îÄ‚îÄ UserProfile.js        # Component logic
‚îÇ   ‚îú‚îÄ‚îÄ UserProfile.styles.js # Styled components
‚îÇ   ‚îú‚îÄ‚îÄ UserProfile.test.js   # Tests
‚îÇ   ‚îî‚îÄ‚îÄ components/           # Sub-components
‚îÇ       ‚îú‚îÄ‚îÄ UserAvatar.js
‚îÇ       ‚îî‚îÄ‚îÄ UserStats.js
```

### Backend/API Code

#### Route Structure
```javascript
// routes/resumeRoutes.js
const express = require('express');
const router = express.Router();
const { authenticate } = require('../middleware/auth');
const resumeController = require('../controllers/resumeController');

// Group related routes
router.get('/', authenticate, resumeController.getAllResumes);
router.get('/:id', authenticate, resumeController.getResumeById);
router.post('/', authenticate, resumeController.createResume);
router.put('/:id', authenticate, resumeController.updateResume);
router.delete('/:id', authenticate, resumeController.deleteResume);

module.exports = router;
```

#### Controller Pattern
```javascript
// controllers/resumeController.js
const resumeService = require('../services/resumeService');

exports.getResumeById = async (req, res) => {
  try {
    const { id } = req.params;
    const userId = req.user.uid;

    // Validate input
    if (!id) {
      return res.status(400).json({ error: 'Resume ID is required' });
    }

    // Business logic in service layer
    const resume = await resumeService.findResumeById(id, userId);

    if (!resume) {
      return res.status(404).json({ error: 'Resume not found' });
    }

    // Success response
    res.status(200).json({ resume });
  } catch (error) {
    console.error('Error fetching resume:', error);
    res.status(500).json({ error: 'Internal server error' });
  }
};
```

#### Service Layer Pattern
```javascript
// services/resumeService.js
const db = require('../config/database');

class ResumeService {
  async findResumeById(resumeId, userId) {
    const query = `
      SELECT * FROM resumes
      WHERE id = $1 AND user_id = $2
    `;
    const result = await db.query(query, [resumeId, userId]);
    return result.rows[0];
  }

  async createResume(resumeData, userId) {
    const { title, content } = resumeData;
    const query = `
      INSERT INTO resumes (user_id, title, content, created_at)
      VALUES ($1, $2, $3, NOW())
      RETURNING *
    `;
    const result = await db.query(query, [userId, title, content]);
    return result.rows[0];
  }
}

module.exports = new ResumeService();
```

---

## üéØ Material-UI (MUI) Conventions

### Styling Approach
```javascript
// ‚úÖ DO: Use sx prop for component-specific styles
<Box
  sx={{
    display: 'flex',
    flexDirection: 'column',
    gap: 2,
    p: 3,
    bgcolor: 'background.paper',
    borderRadius: 1,
    boxShadow: 1,
  }}
>
  <Typography variant="h5" component="h2">
    Title
  </Typography>
</Box>

// ‚úÖ DO: Use theme tokens
sx={{
  color: 'primary.main',      // Not '#1976d2'
  bgcolor: 'background.paper', // Not '#fff'
  spacing: 2,                  // theme.spacing(2)
}}

// ‚úÖ DO: Use responsive values
sx={{
  width: { xs: '100%', md: '50%' },
  fontSize: { xs: 14, sm: 16, md: 18 },
}}
```

### Component Patterns
```javascript
// ‚úÖ DO: Use Grid2 for layouts
import Grid from '@mui/material/Grid2';

<Grid container spacing={2}>
  <Grid xs={12} md={6}>
    <LeftPanel />
  </Grid>
  <Grid xs={12} md={6}>
    <RightPanel />
  </Grid>
</Grid>

// ‚úÖ DO: Use proper button variants
<Button variant="contained" color="primary">
  Primary Action
</Button>
<Button variant="outlined" color="secondary">
  Secondary Action
</Button>
<Button variant="text">
  Tertiary Action
</Button>
```

---

## üß™ Testing Standards

### Playwright E2E Tests
```javascript
// tests/authentication.spec.js
import { test, expect } from '@playwright/test';

test.describe('Authentication Flow', () => {
  test.beforeEach(async ({ page }) => {
    await page.goto('/');
  });

  test('should allow user to sign in with Google', async ({ page }) => {
    // Arrange
    await page.click('[data-testid="google-signin-button"]');
    
    // Act
    await page.fill('[data-testid="email-input"]', 'test@example.com');
    await page.fill('[data-testid="password-input"]', 'password123');
    await page.click('[data-testid="submit-button"]');
    
    // Assert
    await expect(page.locator('[data-testid="user-menu"]')).toBeVisible();
    await expect(page).toHaveURL('/dashboard');
  });

  test('should show error on invalid credentials', async ({ page }) => {
    // Arrange & Act
    await page.click('[data-testid="google-signin-button"]');
    await page.fill('[data-testid="email-input"]', 'invalid@example.com');
    await page.fill('[data-testid="password-input"]', 'wrong');
    await page.click('[data-testid="submit-button"]');
    
    // Assert
    await expect(page.locator('[data-testid="error-message"]')).toContainText('Invalid credentials');
  });
});
```

### Test Data Attributes
```javascript
// ‚úÖ DO: Add data-testid to testable elements
<Button data-testid="submit-resume-button" onClick={handleSubmit}>
  Submit Resume
</Button>

<TextField
  data-testid="resume-title-input"
  label="Resume Title"
  value={title}
  onChange={handleTitleChange}
/>
```

---

## üìù Documentation Standards

### File Headers
```javascript
/**
 * Component: ResumeEditor
 * Purpose: Provides rich text editing interface for resume content
 * 
 * Features:
 * - Real-time autosave
 * - Format preservation
 * - AI-powered suggestions
 * 
 * @author CVStomize Team
 * @since 2024-11-01
 */
```

### Function Documentation
```javascript
/**
 * Generates a PDF from resume data
 * 
 * @param {Object} resumeData - The resume content and metadata
 * @param {string} resumeData.title - Resume title
 * @param {string} resumeData.content - Resume HTML content
 * @param {string} templateId - PDF template identifier
 * @returns {Promise<Buffer>} PDF file buffer
 * @throws {Error} If template not found or generation fails
 * 
 * @example
 * const pdf = await generatePDF({ title: 'My Resume', content: '<html>...' }, 'template-1');
 */
async function generatePDF(resumeData, templateId) {
  // Implementation
}
```

### Inline Comments
```javascript
// ‚úÖ DO: Explain WHY, not WHAT
// Calculate expiration using 7-day window to align with billing cycle
const expirationDate = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000);

// ‚úÖ DO: Mark TODOs clearly
// TODO(username): Implement rate limiting for API calls
// FIXME: Memory leak when unmounting component
// HACK: Temporary workaround until API supports pagination

// ‚ùå DON'T: State the obvious
// Bad: // Set loading to true
setLoading(true);
```

---

## üîí Security & Best Practices

### Authentication
```javascript
// ‚úÖ DO: Always verify user authentication
const authenticatedRoute = async (req, res) => {
  if (!req.user) {
    return res.status(401).json({ error: 'Unauthorized' });
  }
  // Proceed with authenticated logic
};

// ‚úÖ DO: Check resource ownership
const resume = await Resume.findById(id);
if (resume.userId !== req.user.uid) {
  return res.status(403).json({ error: 'Forbidden' });
}
```

### Environment Variables
```javascript
// ‚úÖ DO: Use environment variables for sensitive data
const config = {
  apiKey: process.env.REACT_APP_FIREBASE_API_KEY,
  databaseUrl: process.env.DATABASE_URL,
  port: process.env.PORT || 3000,
};

// ‚ùå DON'T: Hardcode credentials
// Bad: const apiKey = 'AIzaSyC...';
```

### Error Handling
```javascript
// ‚úÖ DO: Handle errors gracefully
try {
  const data = await apiCall();
  return data;
} catch (error) {
  // Log with context
  console.error('API call failed:', {
    endpoint: '/api/resumes',
    error: error.message,
    userId: req.user?.uid,
  });
  
  // Return user-friendly message
  return res.status(500).json({
    error: 'Unable to fetch resumes. Please try again later.',
  });
}

// ‚úÖ DO: Validate input
const validateResumeInput = (data) => {
  if (!data.title || data.title.trim().length === 0) {
    throw new Error('Resume title is required');
  }
  if (data.title.length > 200) {
    throw new Error('Resume title must be 200 characters or less');
  }
  return true;
};
```

---

## üì¶ Commit & PR Guidelines

### Commit Messages
```bash
# Format: <type>(<scope>): <subject>

# Types: feat, fix, docs, style, refactor, test, chore
feat(resume): add auto-save functionality
fix(auth): resolve Google SSO redirect issue
docs(readme): update installation instructions
style(ui): improve button spacing in header
refactor(api): extract resume validation logic
test(e2e): add tests for PDF generation
chore(deps): update dependencies
```

### Pull Request Template
```markdown
## Description
Brief description of changes

## Type of Change
- [ ] Bug fix
- [ ] New feature
- [ ] Breaking change
- [ ] Documentation update

## Testing
- [ ] E2E tests pass
- [ ] Manual testing completed
- [ ] No console errors

## Screenshots (if applicable)
[Add screenshots]

## Checklist
- [ ] Code follows project style guidelines
- [ ] Self-review completed
- [ ] Comments added to complex code
- [ ] Documentation updated
```

---

## üöÄ AI Agent-Specific Instructions

### When Making Changes

1. **Read First:** Always check existing code in the area you're modifying
2. **Context Matters:** Review related files (components, tests, docs)
3. **Test Coverage:** Add/update tests for new features
4. **Documentation:** Update relevant documentation
5. **Consistency:** Match existing patterns in the codebase

### Code Generation Preferences

```javascript
// ‚úÖ PREFER: Async/await
async function fetchData() {
  const result = await api.get('/data');
  return result;
}

// ‚ùå AVOID: Promise chains
function fetchData() {
  return api.get('/data').then(result => result);
}

// ‚úÖ PREFER: Functional programming
const activeUsers = users.filter(u => u.isActive);
const userNames = users.map(u => u.name);

// ‚ùå AVOID: Imperative loops when map/filter/reduce work
let activeUsers = [];
for (let i = 0; i < users.length; i++) {
  if (users[i].isActive) {
    activeUsers.push(users[i]);
  }
}

// ‚úÖ PREFER: Explicit error handling
try {
  await operation();
} catch (error) {
  console.error('Operation failed:', error);
  handleError(error);
}

// ‚ùå AVOID: Silent failures
try {
  await operation();
} catch (error) {
  // Empty catch block
}
```

### File Operations

- **Creating Files:** Use proper directory structure
- **Modifying Files:** Make surgical changes, preserve existing style
- **Deleting Code:** Remove carefully, check for dependencies
- **Refactoring:** Do incrementally, maintain functionality

### Common Patterns to Follow

```javascript
// API Response Format
{
  success: true,
  data: { /* payload */ },
  message: 'Operation successful'
}

// Error Response Format
{
  success: false,
  error: 'Error message',
  details: { /* additional context */ }
}

// Component Loading States
if (loading) return <LoadingSpinner />;
if (error) return <ErrorMessage error={error} />;
if (!data) return <NoDataMessage />;
return <DataDisplay data={data} />;
```

---

## üõ†Ô∏è Development Workflow

### Local Development
```bash
# Frontend (port 3000)
npm start

# Backend API (port 5000)
cd api && npm start

# Run tests
npm run test:e2e

# View test report
npm run test:report
```

### Before Committing
1. Run linter: `npm run lint`
2. Run tests: `npm run test:e2e`
3. Check for console errors
4. Review git diff
5. Update documentation if needed

### Project-Specific Commands
```bash
# Git sync (stage, commit, pull, push)
./scripts/git-sync.sh

# Seed staging database
./scripts/seed-staging.sh

# Deploy to Cloud Run
cd api && ./deploy-to-cloud-run.sh
```

---

## üìö Additional Resources

- **Main README:** `/README.md` - Project overview
- **Project Structure:** `/PROJECT_STRUCTURE.md` - Detailed architecture
- **Testing Guide:** `/COMPLETE_UI_TESTING_GUIDE.md` - Testing strategy
- **Roadmap:** `/ROADMAP.md` - Future plans
- **API Documentation:** `/api/README.md` - Backend API details

---

## ‚úÖ Quick Checklist for AI Agents

Before submitting any code changes:

- [ ] Code follows formatting standards (indentation, naming, structure)
- [ ] Material-UI components use sx prop and theme tokens
- [ ] Error handling implemented properly
- [ ] Input validation included
- [ ] Test data attributes added where needed
- [ ] Documentation comments added for complex logic
- [ ] No hardcoded credentials or sensitive data
- [ ] Existing tests still pass
- [ ] Code is DRY (Don't Repeat Yourself)
- [ ] Console.logs removed (except for legitimate logging)
- [ ] Commit message follows format guidelines

---

## ü§ù Collaboration Notes

When multiple AI agents work on this project:

1. **Pull latest changes** before starting work
2. **Check for conflicts** in your working area
3. **Coordinate on shared files** (avoid simultaneous edits)
4. **Use descriptive branch names** (`feature/resume-autosave`, `fix/auth-redirect`)
5. **Small, focused commits** over large monolithic changes
6. **Test your changes** before pushing
7. **Document breaking changes** clearly

---

**Version:** 1.0  
**Maintained by:** CVStomize Team  
**Questions?** Check project documentation or ask the team lead
